<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: api/session.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: api/session.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { deepClone } from "../utils/object"
import Action from "./session/action"

/** *****************************************************************************
 * Copyright (c) 2018 Nosto Solutions Ltd All Rights Reserved.
 * &lt;p>
 * This software is the confidential and proprietary information of
 * Nosto Solutions Ltd ("Confidential Information"). You shall not
 * disclose such Confidential Information and shall use it only in
 * accordance with the terms of the agreement you entered into with
 * Nosto Solutions Ltd.
 ***************************************************************************** */

/**
 * @constructor
 */
function Session() {
  // same structure as in tagging
  const data = {
    // session scope
    // (for data that should outlive the page scope)
    cart: { items: [] },
    customer: undefined,
    variation: undefined,
    external_visit_ref: undefined,
    restore_link: undefined,
    // action scope
    // (for data that is scoped to individual pages or even smaller scopes)
    products: [],
    order: undefined,
    search_terms: [],
    categories: [],
    tags: [],
    customFields: [],
    elements: [],
    page_type: undefined
  }

  const logs = []
  let responseMode = "JSON_ORIGINAL"

  function newAction() {
    return new Action(logs, deepClone(data), responseMode)
  }

  // noinspection JSUnusedGlobalSymbols
  this.logs = () => {
    return logs
  }

  /**
   * @param cart
   * @return {Session}
   */
  this.setCart = cart => {
    data.cart = cart
    return this
  }

  /**
   * @param customer
   * @returns {Session}
   */
  this.setCustomer = customer => {
    data.customer = customer
    return this
  }

  /**
   * @param variation
   * @returns {Session}
   */
  this.setVariation = variation => {
    data.variation = variation
    return this
  }

  // noinspection JSUnusedGlobalSymbols
  /**
   * @param ref
   * @returns {Session}
   */
  this.setExternalVisitRef = ref => {
    data.external_visit_ref = ref
    return this
  }

  // noinspection JSUnusedGlobalSymbols
  /**
   * @param restoreLink
   * @returns {Session}
   */
  this.setRestoreLink = restoreLink => {
    data.restore_link = restoreLink
    return this
  }

  // noinspection JSUnusedGlobalSymbols
  /**
   * Create a new action for a front page
   * @memberof Session
   * @instance
   * @returns {Action}
   */
  this.viewFrontPage = () => {
    return newAction().setPageType("front")
  }

  /**
   * Create a new action for a cart page
   * @instance
   * @returns {Action}
   */
  this.viewCart = () => {
    return newAction().setPageType("cart")
  }

  // noinspection JSUnusedGlobalSymbols
  /**
   * Create a new action for a not found page
   * @returns {Action}
   */
  this.viewNotFound = () => {
    return newAction().setPageType("notfound")
  }

  /**
   * Create a new action for a product page
   * @param product
   * @returns {Action}
   */
  this.viewProduct = product => {
    return newAction().setPageType("product").setProduct(product)
  }

  /**
   * Create a new action for a category page
   *
   * @param categories
   * @returns {Action}
   */
  this.viewCategory = (...categories) => {
    return newAction().setPageType("category").setCategories(categories)
  }

  /**
   * Create a new action for a tag page
   *
   * @param tags
   * @returns {Action}
   */
  this.viewTag = (...tags) => {
    return newAction().setTags(tags)
  }

  // noinspection JSUnusedGlobalSymbols
  /**
   * Create a new action for a search page
   *
   * @param searchTerms
   * @returns {Action}
   */
  this.viewSearch = (...searchTerms) => {
    return newAction().setPageType("search").setSearchTerms(searchTerms)
  }

  /**
   * Create a new action for a general page
   *
   * @returns {Action}
   */
  this.viewOther = () => {
    return newAction()
  }

  /**
   * Create a new action for an order page
   *
   * @param order
   * @returns {Action}
   */
  this.addOrder = order => {
    return newAction().setPageType("order").setOrder(order)
  }

  /**
   * Creates an action to report that product was added to the shopping cart,
   * e.g. from the recommendation slot with "Add to cart" button
   *
   * @param product
   * @param element
   * @returns {Action}
   */
  this.reportAddToCart = (product, element) => {
    return newAction().setRef(product, element)
  }

  /**
   * Sets the response type to HTML or JSON_ORIGINAL
   * e.g. from the recommendation slot with "Add to cart" button
   *
   * @param mode
   * @returns {Session}
   */
  this.setResponseMode = mode => {
    responseMode = mode
    return this
  }
}

export default Session
export const sessionInstance = new Session()
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Action.html">Action</a></li><li><a href="ActionResponse.html">ActionResponse</a></li><li><a href="Api.html">Api</a></li><li><a href="Session.html">Session</a></li></ul><h3>Global</h3><ul><li><a href="global.html#enhanceProduct">enhanceProduct</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.5</a> on Fri Jul 24 2020 13:12:08 GMT+0300 (Eastern European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
